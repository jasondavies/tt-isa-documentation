<svg version="1.1" width="930" height="735" xmlns="http://www.w3.org/2000/svg"><rect width="930" height="735" rx="15" stroke="transparent" fill="white"/><rect x="114.5" y="5.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="204" y="29" text-anchor="middle" dominant-baseline="middle">Stream idle</text><rect x="114.5" y="71.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="204" y="85" text-anchor="middle" dominant-baseline="middle">Software sets</text><text x="204" y="105" text-anchor="middle" dominant-baseline="middle">configuration</text><rect x="114.5" y="137.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="204" y="151" text-anchor="middle" dominant-baseline="middle">Software starts</text><text x="204" y="171" text-anchor="middle" dominant-baseline="middle">the phase</text><rect x="114.5" y="203.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="204" y="217" text-anchor="middle" dominant-baseline="middle">Wait for previous phase</text><text x="204" y="237" text-anchor="middle" dominant-baseline="middle">L1 reads to complete</text><path d="M 114.5 334.5 L 204.5 269.5 L 294.5 334.5 L 204.5 399.5 Z" stroke="black" fill="#87deaa" stroke-width="1"/><text x="204" y="314" text-anchor="middle" dominant-baseline="middle">Expecting to</text><text x="204" y="334" text-anchor="middle" dominant-baseline="middle">handle any messages</text><text x="204" y="354" text-anchor="middle" dominant-baseline="middle">this phase?</text><rect x="114.5" y="419.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="204" y="433" text-anchor="middle" dominant-baseline="middle">Handshake with</text><text x="204" y="453" text-anchor="middle" dominant-baseline="middle">configured source</text><rect x="314.5" y="485.5" width="120" height="46" stroke="black" fill="#f4d7e3" stroke-width="1"/><text x="374" y="499" text-anchor="middle" dominant-baseline="middle">Message header</text><text x="374" y="519" text-anchor="middle" dominant-baseline="middle">array (in L1)</text><rect x="454.5" y="485.5" width="130" height="46" stroke="black" fill="#f4d7e3" stroke-width="1"/><text x="519" y="499" text-anchor="middle" dominant-baseline="middle">Message metadata</text><text x="519" y="519" text-anchor="middle" dominant-baseline="middle">FIFO (in stream)</text><rect x="314.5" y="551.5" width="270" height="46" stroke="black" fill="#f4d7e3" stroke-width="1"/><text x="449" y="565" text-anchor="middle" dominant-baseline="middle">Receive buffer</text><text x="449" y="585" text-anchor="middle" dominant-baseline="middle">FIFO (in L1)</text><rect x="114.5" y="501.25" width="180" height="80.5" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="204" y="522" text-anchor="middle" dominant-baseline="middle">Receive configured</text><text x="204" y="542" text-anchor="middle" dominant-baseline="middle">number of messages</text><text x="204" y="562" text-anchor="middle" dominant-baseline="middle">from configured source</text><rect x="604.5" y="501.25" width="180" height="80.5" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="694" y="522" text-anchor="middle" dominant-baseline="middle">Transmit configured</text><text x="694" y="542" text-anchor="middle" dominant-baseline="middle">number of messages to</text><text x="694" y="562" text-anchor="middle" dominant-baseline="middle">configured destination</text><rect x="604.5" y="419.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="694" y="433" text-anchor="middle" dominant-baseline="middle">Handshake with</text><text x="694" y="453" text-anchor="middle" dominant-baseline="middle">configured destination</text><rect x="529.5" y="617.5" width="130" height="46" stroke="black" fill="#f4d7e3" stroke-width="1"/><text x="594" y="631" text-anchor="middle" dominant-baseline="middle">L1 read complete</text><text x="594" y="651" text-anchor="middle" dominant-baseline="middle">FIFO (in stream)</text><rect x="604.5" y="683.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="694" y="697" text-anchor="middle" dominant-baseline="middle">Wait for destination</text><text x="694" y="717" text-anchor="middle" dominant-baseline="middle">mostly (or entirely) done</text><text x="299" y="330" text-anchor="start" dominant-baseline="auto">No</text><path d="M 84.5 490.5 L 94.5 495.5 L 94.5 587.5 L 84.5 592.5 Z" stroke="black" fill="#e9ddaf" stroke-width="1"/><text x="73" y="507" text-anchor="end" dominant-baseline="middle">Software</text><path d="M 75 503.5 L 75 507.5 L 84 507.5 L 84 503.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="73" y="531" text-anchor="end" dominant-baseline="middle">NoC</text><path d="M 75 527.5 L 75 531.5 L 84 531.5 L 84 527.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="73" y="555" text-anchor="end" dominant-baseline="middle">Ethernet</text><path d="M 75 551.5 L 75 555.5 L 84 555.5 L 84 551.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="73" y="579" text-anchor="end" dominant-baseline="middle">Gather in</text><path d="M 75 575.5 L 75 579.5 L 84 579.5 L 84 575.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 804.5 495.5 L 814.5 490.5 L 814.5 592.5 L 804.5 587.5 Z" stroke="black" fill="#e9ddaf" stroke-width="1"/><text x="830" y="507" text-anchor="start" dominant-baseline="middle">Software</text><path d="M 815 503.5 L 815 507.5 L 822.5 507.5 L 822.5 511.5 L 828.5 505.5 L 822.5 499.5 L 822.5 503.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="830" y="531" text-anchor="start" dominant-baseline="middle">NoC</text><path d="M 815 527.5 L 815 531.5 L 822.5 531.5 L 822.5 535.5 L 828.5 529.5 L 822.5 523.5 L 822.5 527.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="830" y="555" text-anchor="start" dominant-baseline="middle">Ethernet</text><path d="M 815 551.5 L 815 555.5 L 822.5 555.5 L 822.5 559.5 L 828.5 553.5 L 822.5 547.5 L 822.5 551.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="830" y="579" text-anchor="start" dominant-baseline="middle">Gather out</text><path d="M 815 575.5 L 815 579.5 L 822.5 579.5 L 822.5 583.5 L 828.5 577.5 L 822.5 571.5 L 822.5 575.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 204.5 582.75 L 204.5 703.5 Q 204.5 706.5 207.5 706.5 L 602.5 706.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 599.5 709.5 L 602.5 706.5 L 599.5 703.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 85.5 429 L 85.5 425 L 79.5 431 L 85.5 437 L 85.5 433 L 114 433 L 114 429 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 79.5 452 L 79.5 456 L 107.5 456 L 107.5 460 L 113.5 454 L 107.5 448 L 107.5 452 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 791.5 429 L 791.5 425 L 785.5 431 L 791.5 437 L 791.5 433 L 819.5 433 L 819.5 429 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 785 452 L 785 456 L 813.5 456 L 813.5 460 L 819.5 454 L 813.5 448 L 813.5 452 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<rect x="719.5" y="353.5" width="130" height="46" stroke="black" fill="#f4d7e3" stroke-width="1"/><text x="784" y="367" text-anchor="middle" dominant-baseline="middle">Handshake cache</text><text x="784" y="387" text-anchor="middle" dominant-baseline="middle">(in overlay)</text><path d="M 754 400 L 750 400 L 750 412.5 L 746 412.5 L 752 418.5 L 758 412.5 L 754 412.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 806.5 406.5 L 810.5 406.5 L 804.5 400.5 L 798.5 406.5 L 802.5 406.5 L 802.5 431 L 806.5 431 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 204.5 52.5 L 204.5 69.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 201.5 66.5 L 204.5 69.5 L 207.5 66.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 204.5 118.5 L 204.5 135.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 201.5 132.5 L 204.5 135.5 L 207.5 132.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 204.5 184.5 L 204.5 201.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 201.5 198.5 L 204.5 201.5 L 207.5 198.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 204.5 250.5 L 204.5 267.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 201.5 264.5 L 204.5 267.5 L 207.5 264.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 204.5 400.5 L 204.5 417.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 201.5 414.5 L 204.5 417.5 L 207.5 414.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 204.5 466.5 L 204.5 499.25" stroke="black" fill="transparent" stroke-width="1"/><path d="M 201.5 496.25 L 204.5 499.25 L 207.5 496.25" stroke="black" fill="transparent" stroke-width="1"/><path d="M 204.5 404.5 L 691.5 404.5 Q 694.5 404.5 694.5 407.5 L 694.5 417.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 691.5 414.5 L 694.5 417.5 L 697.5 414.5" stroke="black" fill="transparent" stroke-width="1"/><text x="200" y="406" text-anchor="end" dominant-baseline="middle">Yes</text><path d="M 694.5 466.5 L 694.5 499.25" stroke="black" fill="transparent" stroke-width="1"/><path d="M 691.5 496.25 L 694.5 499.25 L 697.5 496.25" stroke="black" fill="transparent" stroke-width="1"/><path d="M 632 582.75 L 632 615.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 629 612.5 L 632 615.5 L 635 612.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 694.5 582.75 L 694.5 681.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 691.5 678.5 L 694.5 681.5 L 697.5 678.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 557 616.5 L 557 599.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 560 602.5 L 557 599.5 L 554 602.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 95 539.5 L 95 543.5 L 107.5 543.5 L 107.5 547.5 L 113.5 541.5 L 107.5 535.5 L 107.5 539.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 295 564.625 L 295 568.625 L 307.5 568.625 L 307.5 572.625 L 313.5 566.625 L 307.5 560.625 L 307.5 564.625 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 585 564.625 L 585 568.625 L 597.5 568.625 L 597.5 572.625 L 603.5 566.625 L 597.5 560.625 L 597.5 564.625 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 785 539.5 L 785 543.5 L 804 543.5 L 804 539.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 295 514.375 L 295 518.375 L 307.5 518.375 L 307.5 522.375 L 313.5 516.375 L 307.5 510.375 L 307.5 514.375 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 435 506.5 L 435 510.5 L 447.5 510.5 L 447.5 514.5 L 453.5 508.5 L 447.5 502.5 L 447.5 506.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 585 514.375 L 585 518.375 L 597.5 518.375 L 597.5 522.375 L 603.5 516.375 L 597.5 510.375 L 597.5 514.375 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 515 638.5 L 515 634.5 L 509 640.5 L 515 646.5 L 515 642.5 L 529 642.5 L 529 638.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<text x="507" y="641" text-anchor="end" dominant-baseline="middle">Flow control to source</text><text x="724" y="641" text-anchor="start" dominant-baseline="middle">Flow control from destination</text><path d="M 714.5 637.5 L 714.5 641.5 L 722.5 641.5 L 722.5 637.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 716.5 589.75 L 720.5 589.75 L 714.5 583.75 L 708.5 589.75 L 712.5 589.75 L 712.5 675.5 L 708.5 675.5 L 714.5 681.5 L 720.5 675.5 L 716.5 675.5 Z" stroke="transparent" fill="#aaaaff" stroke-width="1"/>
<path d="M 314.5 160.5 L 404.5 95.5 L 494.5 160.5 L 404.5 225.5 Z" stroke="black" fill="#87deaa" stroke-width="1"/><text x="404" y="140" text-anchor="middle" dominant-baseline="middle">Configured to</text><text x="404" y="160" text-anchor="middle" dominant-baseline="middle">automatically</text><text x="404" y="180" text-anchor="middle" dominant-baseline="middle">start phase?</text><rect x="514.5" y="137.5" width="180" height="46" stroke="black" fill="#d4aa00" stroke-width="1"/><text x="604" y="151" text-anchor="middle" dominant-baseline="middle">Load configuration</text><text x="604" y="171" text-anchor="middle" dominant-baseline="middle">for phase from L1</text><path d="M 714.5 160.5 L 804.5 95.5 L 894.5 160.5 L 804.5 225.5 Z" stroke="black" fill="#87deaa" stroke-width="1"/><text x="804" y="140" text-anchor="middle" dominant-baseline="middle">Has pointer</text><text x="804" y="160" text-anchor="middle" dominant-baseline="middle">to configuration for</text><text x="804" y="180" text-anchor="middle" dominant-baseline="middle">next phase?</text><text x="322" y="150" text-anchor="end" dominant-baseline="auto">No</text><text x="722" y="150" text-anchor="end" dominant-baseline="auto">Yes</text><text x="808" y="90" text-anchor="start" dominant-baseline="auto">No</text><text x="408" y="230" text-anchor="start" dominant-baseline="hanging">Yes</text><path d="M 313.5 160.5 L 296.5 160.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 299.5 157.5 L 296.5 160.5 L 299.5 163.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 513.5 160.5 L 496.5 160.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 499.5 157.5 L 496.5 160.5 L 499.5 163.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 713.5 160.5 L 696.5 160.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 699.5 157.5 L 696.5 160.5 L 699.5 163.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 785.5 706.5 L 921.5 706.5 Q 924.5 706.5 924.5 703.5 L 924.5 163.5 Q 924.5 160.5 921.5 160.5 L 896.5 160.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 899.5 157.5 L 896.5 160.5 L 899.5 163.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 295.5 334.5 L 801.5 334.5 Q 804.5 334.5 804.5 331.5 L 804.5 227.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 807.5 230.5 L 804.5 227.5 L 801.5 230.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 804.5 94.5 L 804.5 31.5 Q 804.5 28.5 801.5 28.5 L 296.5 28.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 299.5 25.5 L 296.5 28.5 L 299.5 31.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 404.5 226.5 L 404.5 235 Q 404.5 238 401.5 238 L 296.5 238" stroke="black" fill="transparent" stroke-width="1"/><path d="M 299.5 235 L 296.5 238 L 299.5 241" stroke="black" fill="transparent" stroke-width="1"/><path d="M 295.5 83 L 601.5 83 Q 604.5 83 604.5 86 L 604.5 135.5" stroke="black" fill="transparent" stroke-width="1"/><path d="M 601.5 132.5 L 604.5 135.5 L 607.5 132.5" stroke="black" fill="transparent" stroke-width="1"/><text x="299" y="77" text-anchor="start" dominant-baseline="auto">Optional</text></svg>
